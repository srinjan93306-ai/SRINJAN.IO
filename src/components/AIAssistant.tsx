import React, { useState, useRef, useEffect } from 'react';
import { Bot, Send, User, Lightbulb, Code, HelpCircle, Sparkles, MessageCircle, Zap, Target, CheckCircle } from 'lucide-react';
import { getTranslation } from '../utils/languageTranslations';

interface Message {
  id: string;
  type: 'user' | 'ai';
  content: string;
  timestamp: Date;
  codeExample?: string;
  category?: string;
}

interface AIAssistantProps {
  currentCode: string;
  selectedLanguage: string;
  humanLanguage: string;
  onCodeSuggestion: (code: string) => void;
}

export const AIAssistant: React.FC<AIAssistantProps> = ({
  currentCode,
  selectedLanguage,
  humanLanguage,
  onCodeSuggestion
}) => {
  const [messages, setMessages] = useState<Message[]>([
    {
      id: '1',
      type: 'ai',
      content: `üöÄ **SRINJAN AI Assistant Ready!**\n\nI'm your 100% efficient coding companion! I can create PERFECT code for:\n\n‚úÖ **Any program you describe**\n‚úÖ **Data structures & algorithms**\n‚úÖ **Mathematical calculations**\n‚úÖ **Games and applications**\n‚úÖ **Database operations**\n‚úÖ **File handling**\n\n**Just tell me what you want to build and I'll give you the EXACT code!**\n\nLanguage: **${humanLanguage.toUpperCase()}** üåç`,
      timestamp: new Date(),
      category: 'welcome'
    }
  ]);
  const [inputMessage, setInputMessage] = useState('');
  const [isTyping, setIsTyping] = useState(false);
  const messagesEndRef = useRef<HTMLDivElement>(null);

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  const getTranslatedKeyword = (keyword: string): string => {
    const translations: any = {
      en: {
        display: 'DISPLAY',
        input: 'INPUT BY USER',
        calculate: 'CALCULATE',
        store: 'STORE',
        create: 'CREATE',
        if: 'IF',
        otherwise: 'OTHERWISE',
        endif: 'END IF',
        repeat: 'REPEAT',
        endrepeat: 'END REPEAT',
        function: 'DEFINE FUNCTION',
        endfunction: 'END FUNCTION',
        call: 'CALL',
        return: 'RETURN',
        array: 'ARRAY',
        stack: 'STACK',
        queue: 'QUEUE',
        push: 'PUSH',
        pop: 'POP',
        enqueue: 'ENQUEUE',
        dequeue: 'DEQUEUE',
        insert: 'INSERT',
        delete: 'DELETE',
        search: 'SEARCH',
        sort: 'SORT',
        while: 'WHILE',
        for: 'FOR',
        break: 'BREAK',
        continue: 'CONTINUE'
      },
      hi: {
        display: '‡§¶‡§ø‡§ñ‡§æ‡§è‡§Ç',
        input: '‡§â‡§™‡§Ø‡•ã‡§ó‡§ï‡§∞‡•ç‡§§‡§æ ‡§∏‡•á ‡§á‡§®‡§™‡•Å‡§ü',
        calculate: '‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç',
        store: '‡§∏‡§Ç‡§ó‡•ç‡§∞‡§π‡•Ä‡§§ ‡§ï‡§∞‡•á‡§Ç',
        create: '‡§¨‡§®‡§æ‡§è‡§Ç',
        if: '‡§Ø‡§¶‡§ø',
        otherwise: '‡§Ö‡§®‡•ç‡§Ø‡§•‡§æ',
        endif: '‡§Ø‡§¶‡§ø ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§',
        repeat: '‡§¶‡•ã‡§π‡§∞‡§æ‡§è‡§Ç',
        endrepeat: '‡§¶‡•ã‡§π‡§∞‡§æ‡§®‡§æ ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§',
        function: '‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§™‡§∞‡§ø‡§≠‡§æ‡§∑‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç',
        endfunction: '‡§´‡§º‡§Ç‡§ï‡•ç‡§∂‡§® ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§',
        call: '‡§ï‡•â‡§≤ ‡§ï‡§∞‡•á‡§Ç',
        return: '‡§µ‡§æ‡§™‡§∏ ‡§ï‡§∞‡•á‡§Ç',
        array: '‡§∏‡§∞‡§£‡•Ä',
        stack: '‡§∏‡•ç‡§ü‡•à‡§ï',
        queue: '‡§ï‡§§‡§æ‡§∞',
        push: '‡§ß‡§ï‡•ç‡§ï‡§æ ‡§¶‡•á‡§Ç',
        pop: '‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç',
        enqueue: '‡§ï‡§§‡§æ‡§∞ ‡§Æ‡•á‡§Ç ‡§°‡§æ‡§≤‡•á‡§Ç',
        dequeue: '‡§ï‡§§‡§æ‡§∞ ‡§∏‡•á ‡§®‡§ø‡§ï‡§æ‡§≤‡•á‡§Ç',
        insert: '‡§∏‡§Æ‡•ç‡§Æ‡§ø‡§≤‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç',
        delete: '‡§π‡§ü‡§æ‡§è‡§Ç',
        search: '‡§ñ‡•ã‡§ú‡•á‡§Ç',
        sort: '‡§ï‡•ç‡§∞‡§Æ‡§¨‡§¶‡•ç‡§ß ‡§ï‡§∞‡•á‡§Ç',
        while: '‡§ú‡§¨ ‡§§‡§ï',
        for: '‡§ï‡•á ‡§≤‡§ø‡§è',
        break: '‡§§‡•ã‡§°‡§º‡•á‡§Ç',
        continue: '‡§ú‡§æ‡§∞‡•Ä ‡§∞‡§ñ‡•á‡§Ç'
      },
      es: {
        display: 'MOSTRAR',
        input: 'ENTRADA DEL USUARIO',
        calculate: 'CALCULAR',
        store: 'ALMACENAR',
        create: 'CREAR',
        if: 'SI',
        otherwise: 'DE LO CONTRARIO',
        endif: 'FIN SI',
        repeat: 'REPETIR',
        endrepeat: 'FIN REPETIR',
        function: 'DEFINIR FUNCI√ìN',
        endfunction: 'FIN FUNCI√ìN',
        call: 'LLAMAR',
        return: 'RETORNAR',
        array: 'ARREGLO',
        stack: 'PILA',
        queue: 'COLA',
        push: 'EMPUJAR',
        pop: 'SACAR',
        enqueue: 'ENCOLAR',
        dequeue: 'DESENCOLAR',
        insert: 'INSERTAR',
        delete: 'ELIMINAR',
        search: 'BUSCAR',
        sort: 'ORDENAR',
        while: 'MIENTRAS',
        for: 'PARA',
        break: 'ROMPER',
        continue: 'CONTINUAR'
      },
      bn: {
        display: '‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®',
        input: '‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶á‡¶®‡¶™‡ßÅ‡¶ü',
        calculate: '‡¶ó‡¶£‡¶®‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®',
        store: '‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®',
        create: '‡¶§‡ßà‡¶∞‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®',
        if: '‡¶Ø‡¶¶‡¶ø',
        otherwise: '‡¶Ö‡¶®‡ßç‡¶Ø‡¶•‡¶æ‡¶Ø‡¶º',
        endif: '‡¶Ø‡¶¶‡¶ø ‡¶∂‡ßá‡¶∑',
        repeat: '‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø ‡¶ï‡¶∞‡ßÅ‡¶®',
        endrepeat: '‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡¶¨‡ßÉ‡¶§‡ßç‡¶§‡¶ø ‡¶∂‡ßá‡¶∑',
        function: '‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶∏‡¶Ç‡¶ú‡ßç‡¶û‡¶æ‡¶Ø‡¶º‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®',
        endfunction: '‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶∂‡ßá‡¶∑',
        call: '‡¶ï‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®',
        return: '‡¶´‡ßá‡¶∞‡¶§ ‡¶¶‡¶ø‡¶®',
        array: '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∞‡ßá',
        stack: '‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ï',
        queue: '‡¶∏‡¶æ‡¶∞‡¶ø',
        push: '‡¶ß‡¶æ‡¶ï‡ßç‡¶ï‡¶æ ‡¶¶‡¶ø‡¶®',
        pop: '‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®',
        enqueue: '‡¶∏‡¶æ‡¶∞‡¶ø‡¶§‡ßá ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®',
        dequeue: '‡¶∏‡¶æ‡¶∞‡¶ø ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡ßá‡¶∞ ‡¶ï‡¶∞‡ßÅ‡¶®',
        insert: '‡¶∏‡¶®‡ßç‡¶®‡¶ø‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®',
        delete: '‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡ßÅ‡¶®',
        search: '‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®',
        sort: '‡¶∏‡¶æ‡¶ú‡¶æ‡¶®',
        while: '‡¶Ø‡¶§‡¶ï‡ßç‡¶∑‡¶£',
        for: '‡¶ú‡¶®‡ßç‡¶Ø',
        break: '‡¶≠‡¶æ‡¶ô‡ßç‡¶ó‡ßÅ‡¶®',
        continue: '‡¶ö‡¶æ‡¶≤‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶®'
      },
      fr: {
        display: 'AFFICHER',
        input: 'SAISIE UTILISATEUR',
        calculate: 'CALCULER',
        store: 'STOCKER',
        create: 'CR√âER',
        if: 'SI',
        otherwise: 'SINON',
        endif: 'FIN SI',
        repeat: 'R√âP√âTER',
        endrepeat: 'FIN R√âP√âTER',
        function: 'D√âFINIR FONCTION',
        endfunction: 'FIN FONCTION',
        call: 'APPELER',
        return: 'RETOURNER',
        array: 'TABLEAU',
        stack: 'PILE',
        queue: 'FILE',
        push: 'POUSSER',
        pop: 'D√âPILER',
        enqueue: 'ENFILER',
        dequeue: 'D√âFILER',
        insert: 'INS√âRER',
        delete: 'SUPPRIMER',
        search: 'CHERCHER',
        sort: 'TRIER',
        while: 'TANT QUE',
        for: 'POUR',
        break: 'CASSER',
        continue: 'CONTINUER'
      }
    };
    
    return translations[humanLanguage]?.[keyword] || translations.en[keyword] || keyword.toUpperCase();
  };

  const getAIResponse = (userMessage: string): { content: string; codeExample?: string; category: string } => {
    const message = userMessage.toLowerCase();
    
    // PERFECT CODE GENERATION BASED ON USER REQUESTS
    
    // Calculator/Math Programs
    if (message.includes('calculator') || message.includes('math') || message.includes('add') || message.includes('subtract') || message.includes('multiply') || message.includes('divide')) {
      return {
        content: `üßÆ **PERFECT CALCULATOR CODE**\n\nHere's a complete calculator that handles all operations:`,
        codeExample: `${getTranslatedKeyword('display')} "=== CALCULATOR ==="
${getTranslatedKeyword('input')} num1
${getTranslatedKeyword('input')} operation
${getTranslatedKeyword('input')} num2

${getTranslatedKeyword('if')} operation EQUALS "+"
  ${getTranslatedKeyword('calculate')} result = num1 + num2
${getTranslatedKeyword('otherwise')} ${getTranslatedKeyword('if')} operation EQUALS "-"
  ${getTranslatedKeyword('calculate')} result = num1 - num2
${getTranslatedKeyword('otherwise')} ${getTranslatedKeyword('if')} operation EQUALS "*"
  ${getTranslatedKeyword('calculate')} result = num1 * num2
${getTranslatedKeyword('otherwise')} ${getTranslatedKeyword('if')} operation EQUALS "/"
  ${getTranslatedKeyword('calculate')} result = num1 / num2
${getTranslatedKeyword('endif')}

${getTranslatedKeyword('display')} "Result: " + result`,
        category: 'calculator'
      };
    }

    // Game Development
    if (message.includes('game') || message.includes('tic tac toe') || message.includes('snake') || message.includes('quiz')) {
      return {
        content: `üéÆ **PERFECT GAME CODE**\n\nHere's a complete number guessing game:`,
        codeExample: `${getTranslatedKeyword('display')} "=== NUMBER GUESSING GAME ==="
${getTranslatedKeyword('calculate')} secret = 42
${getTranslatedKeyword('calculate')} attempts = 0

${getTranslatedKeyword('repeat')} WHILE attempts < 5
  ${getTranslatedKeyword('input')} guess
  ${getTranslatedKeyword('calculate')} attempts = attempts + 1
  
  ${getTranslatedKeyword('if')} guess EQUALS secret
    ${getTranslatedKeyword('display')} "üéâ CONGRATULATIONS! You won!"
    ${getTranslatedKeyword('break')}
  ${getTranslatedKeyword('otherwise')} ${getTranslatedKeyword('if')} guess < secret
    ${getTranslatedKeyword('display')} "üìà Too low! Try higher"
  ${getTranslatedKeyword('otherwise')}
    ${getTranslatedKeyword('display')} "üìâ Too high! Try lower"
  ${getTranslatedKeyword('endif')}
${getTranslatedKeyword('endrepeat')}

${getTranslatedKeyword('if')} attempts EQUALS 5
  ${getTranslatedKeyword('display')} "üíÄ Game Over! Secret was: " + secret
${getTranslatedKeyword('endif')}`,
        category: 'game'
      };
    }

    // Data Structures
    if (message.includes('stack') || message.includes('queue') || message.includes('array') || message.includes('list')) {
      return {
        content: `üìä **PERFECT DATA STRUCTURE CODE**\n\nComplete implementation with all operations:`,
        codeExample: `${getTranslatedKeyword('display')} "=== DATA STRUCTURES DEMO ==="

// Stack Operations
${getTranslatedKeyword('create')} ${getTranslatedKeyword('stack')} myStack
${getTranslatedKeyword('push')} myStack VALUE 10
${getTranslatedKeyword('push')} myStack VALUE 20
${getTranslatedKeyword('push')} myStack VALUE 30
${getTranslatedKeyword('display')} "Stack after pushes: " + myStack
${getTranslatedKeyword('display')} "Popped: " + ${getTranslatedKeyword('pop')} myStack

// Array Operations
${getTranslatedKeyword('create')} ${getTranslatedKeyword('array')} numbers SIZE 5
${getTranslatedKeyword('store')} 100 AT numbers[0]
${getTranslatedKeyword('store')} 200 AT numbers[1]
${getTranslatedKeyword('store')} 300 AT numbers[2]
${getTranslatedKeyword('display')} "Array: " + numbers

// Queue Operations
${getTranslatedKeyword('create')} ${getTranslatedKeyword('queue')} myQueue
${getTranslatedKeyword('enqueue')} myQueue VALUE "First"
${getTranslatedKeyword('enqueue')} myQueue VALUE "Second"
${getTranslatedKeyword('display')} "Queue: " + myQueue
${getTranslatedKeyword('display')} "Dequeued: " + ${getTranslatedKeyword('dequeue')} myQueue`,
        category: 'data-structures'
      };
    }

    // Sorting Algorithms
    if (message.includes('sort') || message.includes('bubble') || message.includes('algorithm')) {
      return {
        content: `üîÑ **PERFECT SORTING ALGORITHM**\n\nComplete bubble sort implementation:`,
        codeExample: `${getTranslatedKeyword('display')} "=== BUBBLE SORT ALGORITHM ==="
${getTranslatedKeyword('create')} ${getTranslatedKeyword('array')} arr SIZE 5
${getTranslatedKeyword('store')} 64 AT arr[0]
${getTranslatedKeyword('store')} 34 AT arr[1]
${getTranslatedKeyword('store')} 25 AT arr[2]
${getTranslatedKeyword('store')} 12 AT arr[3]
${getTranslatedKeyword('store')} 22 AT arr[4]

${getTranslatedKeyword('display')} "Original array: " + arr

${getTranslatedKeyword('function')} bubbleSort(array)
  ${getTranslatedKeyword('calculate')} n = SIZE OF array
  
  ${getTranslatedKeyword('repeat')} ${getTranslatedKeyword('for')} i FROM 0 TO n-1
    ${getTranslatedKeyword('repeat')} ${getTranslatedKeyword('for')} j FROM 0 TO n-i-2
      ${getTranslatedKeyword('if')} array[j] > array[j+1]
        ${getTranslatedKeyword('calculate')} temp = array[j]
        ${getTranslatedKeyword('store')} array[j+1] AT array[j]
        ${getTranslatedKeyword('store')} temp AT array[j+1]
      ${getTranslatedKeyword('endif')}
    ${getTranslatedKeyword('endrepeat')}
  ${getTranslatedKeyword('endrepeat')}
  
  ${getTranslatedKeyword('return')} array
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('call')} bubbleSort(arr)
${getTranslatedKeyword('display')} "Sorted array: " + arr`,
        category: 'algorithm'
      };
    }

    // Database/CRUD Operations
    if (message.includes('database') || message.includes('crud') || message.includes('student') || message.includes('record')) {
      return {
        content: `üíæ **PERFECT DATABASE OPERATIONS**\n\nComplete CRUD system for student records:`,
        codeExample: `${getTranslatedKeyword('display')} "=== STUDENT MANAGEMENT SYSTEM ==="
${getTranslatedKeyword('create')} ${getTranslatedKeyword('array')} students SIZE 100
${getTranslatedKeyword('calculate')} studentCount = 0

${getTranslatedKeyword('function')} addStudent(name, age, grade)
  ${getTranslatedKeyword('create')} OBJECT student
  SET student.name = name
  SET student.age = age
  SET student.grade = grade
  SET student.id = studentCount + 1
  
  ${getTranslatedKeyword('store')} student AT students[studentCount]
  ${getTranslatedKeyword('calculate')} studentCount = studentCount + 1
  ${getTranslatedKeyword('display')} "‚úÖ Student added: " + name
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('function')} findStudent(name)
  ${getTranslatedKeyword('repeat')} ${getTranslatedKeyword('for')} i FROM 0 TO studentCount-1
    ${getTranslatedKeyword('if')} students[i].name EQUALS name
      ${getTranslatedKeyword('display')} "Found: " + students[i].name + " (Age: " + students[i].age + ")"
      ${getTranslatedKeyword('return')} students[i]
    ${getTranslatedKeyword('endif')}
  ${getTranslatedKeyword('endrepeat')}
  ${getTranslatedKeyword('display')} "‚ùå Student not found"
${getTranslatedKeyword('endfunction')}

// Add sample students
${getTranslatedKeyword('call')} addStudent("Alice", 20, "A")
${getTranslatedKeyword('call')} addStudent("Bob", 19, "B")
${getTranslatedKeyword('call')} addStudent("Charlie", 21, "A")

// Search for student
${getTranslatedKeyword('input')} searchName
${getTranslatedKeyword('call')} findStudent(searchName)`,
        category: 'database'
      };
    }

    // File Operations
    if (message.includes('file') || message.includes('read') || message.includes('write') || message.includes('save')) {
      return {
        content: `üìÅ **PERFECT FILE OPERATIONS**\n\nComplete file handling system:`,
        codeExample: `${getTranslatedKeyword('display')} "=== FILE MANAGEMENT SYSTEM ==="

${getTranslatedKeyword('function')} writeToFile(filename, content)
  ${getTranslatedKeyword('create')} FILE file
  OPEN file AS filename FOR WRITING
  WRITE content TO file
  CLOSE file
  ${getTranslatedKeyword('display')} "‚úÖ File saved: " + filename
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('function')} readFromFile(filename)
  ${getTranslatedKeyword('create')} FILE file
  OPEN file AS filename FOR READING
  ${getTranslatedKeyword('calculate')} content = READ FROM file
  CLOSE file
  ${getTranslatedKeyword('return')} content
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('function')} appendToFile(filename, newContent)
  ${getTranslatedKeyword('create')} FILE file
  OPEN file AS filename FOR APPENDING
  WRITE newContent TO file
  CLOSE file
  ${getTranslatedKeyword('display')} "‚úÖ Content appended to: " + filename
${getTranslatedKeyword('endfunction')}

// Example usage
${getTranslatedKeyword('input')} filename
${getTranslatedKeyword('input')} content
${getTranslatedKeyword('call')} writeToFile(filename, content)

${getTranslatedKeyword('calculate')} fileContent = ${getTranslatedKeyword('call')} readFromFile(filename)
${getTranslatedKeyword('display')} "File content: " + fileContent`,
        category: 'file-operations'
      };
    }

    // Web Development
    if (message.includes('web') || message.includes('html') || message.includes('website') || message.includes('form')) {
      return {
        content: `üåê **PERFECT WEB APPLICATION**\n\nComplete web form with validation:`,
        codeExample: `${getTranslatedKeyword('display')} "=== WEB FORM SYSTEM ==="

${getTranslatedKeyword('function')} validateEmail(email)
  ${getTranslatedKeyword('if')} email CONTAINS "@" AND email CONTAINS "."
    ${getTranslatedKeyword('return')} TRUE
  ${getTranslatedKeyword('otherwise')}
    ${getTranslatedKeyword('return')} FALSE
  ${getTranslatedKeyword('endif')}
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('function')} processForm()
  ${getTranslatedKeyword('display')} "üìù Please fill the form:"
  
  ${getTranslatedKeyword('input')} name
  ${getTranslatedKeyword('input')} email
  ${getTranslatedKeyword('input')} age
  
  // Validation
  ${getTranslatedKeyword('if')} name EQUALS ""
    ${getTranslatedKeyword('display')} "‚ùå Name is required!"
    ${getTranslatedKeyword('return')}
  ${getTranslatedKeyword('endif')}
  
  ${getTranslatedKeyword('if')} NOT ${getTranslatedKeyword('call')} validateEmail(email)
    ${getTranslatedKeyword('display')} "‚ùå Invalid email format!"
    ${getTranslatedKeyword('return')}
  ${getTranslatedKeyword('endif')}
  
  ${getTranslatedKeyword('if')} age < 18
    ${getTranslatedKeyword('display')} "‚ùå Must be 18 or older!"
    ${getTranslatedKeyword('return')}
  ${getTranslatedKeyword('endif')}
  
  // Success
  ${getTranslatedKeyword('display')} "‚úÖ Form submitted successfully!"
  ${getTranslatedKeyword('display')} "Name: " + name
  ${getTranslatedKeyword('display')} "Email: " + email
  ${getTranslatedKeyword('display')} "Age: " + age
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('call')} processForm()`,
        category: 'web-development'
      };
    }

    // Basic Programs
    if (message.includes('hello') || message.includes('start') || message.includes('begin')) {
      return {
        content: `üëã **PERFECT HELLO WORLD PROGRAM**\n\nComplete beginner-friendly example:`,
        codeExample: `${getTranslatedKeyword('display')} "üåü Welcome to SRINJAN!"
${getTranslatedKeyword('display')} "================================"
${getTranslatedKeyword('input')} yourName
${getTranslatedKeyword('display')} "Hello " + yourName + "! üëã"
${getTranslatedKeyword('display')} "You're now coding in ${humanLanguage.toUpperCase()}!"
${getTranslatedKeyword('display')} "================================"
${getTranslatedKeyword('display')} "üöÄ Ready to build amazing things!"`,
        category: 'basic'
      };
    }

    // Loop Examples
    if (message.includes('loop') || message.includes('repeat') || message.includes('iteration')) {
      return {
        content: `üîÑ **PERFECT LOOP EXAMPLES**\n\nAll types of loops with practical examples:`,
        codeExample: `${getTranslatedKeyword('display')} "=== LOOP DEMONSTRATIONS ==="

// Simple repeat loop
${getTranslatedKeyword('display')} "1. Simple Repeat Loop:"
${getTranslatedKeyword('repeat')} 5 TIMES
  ${getTranslatedKeyword('display')} "Iteration: " + CURRENT_ITERATION
${getTranslatedKeyword('endrepeat')}

// While loop
${getTranslatedKeyword('display')} "2. While Loop:"
${getTranslatedKeyword('calculate')} counter = 1
${getTranslatedKeyword('repeat')} ${getTranslatedKeyword('while')} counter <= 3
  ${getTranslatedKeyword('display')} "Counter: " + counter
  ${getTranslatedKeyword('calculate')} counter = counter + 1
${getTranslatedKeyword('endrepeat')}

// For loop with array
${getTranslatedKeyword('display')} "3. For Loop with Array:"
${getTranslatedKeyword('create')} ${getTranslatedKeyword('array')} fruits SIZE 3
${getTranslatedKeyword('store')} "Apple" AT fruits[0]
${getTranslatedKeyword('store')} "Banana" AT fruits[1]
${getTranslatedKeyword('store')} "Orange" AT fruits[2]

${getTranslatedKeyword('repeat')} ${getTranslatedKeyword('for')} i FROM 0 TO 2
  ${getTranslatedKeyword('display')} "Fruit " + (i+1) + ": " + fruits[i]
${getTranslatedKeyword('endrepeat')}`,
        category: 'loops'
      };
    }

    // Function Examples
    if (message.includes('function') || message.includes('method') || message.includes('procedure')) {
      return {
        content: `‚öôÔ∏è **PERFECT FUNCTION EXAMPLES**\n\nComplete function library with parameters and returns:`,
        codeExample: `${getTranslatedKeyword('display')} "=== FUNCTION LIBRARY ==="

${getTranslatedKeyword('function')} greetUser(name, language)
  ${getTranslatedKeyword('if')} language EQUALS "english"
    ${getTranslatedKeyword('return')} "Hello " + name + "!"
  ${getTranslatedKeyword('otherwise')} ${getTranslatedKeyword('if')} language EQUALS "spanish"
    ${getTranslatedKeyword('return')} "¬°Hola " + name + "!"
  ${getTranslatedKeyword('otherwise')}
    ${getTranslatedKeyword('return')} "Hi " + name + "!"
  ${getTranslatedKeyword('endif')}
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('function')} calculateArea(shape, dimension1, dimension2)
  ${getTranslatedKeyword('if')} shape EQUALS "rectangle"
    ${getTranslatedKeyword('return')} dimension1 * dimension2
  ${getTranslatedKeyword('otherwise')} ${getTranslatedKeyword('if')} shape EQUALS "circle"
    ${getTranslatedKeyword('return')} 3.14159 * dimension1 * dimension1
  ${getTranslatedKeyword('otherwise')} ${getTranslatedKeyword('if')} shape EQUALS "triangle"
    ${getTranslatedKeyword('return')} (dimension1 * dimension2) / 2
  ${getTranslatedKeyword('endif')}
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('function')} isPrime(number)
  ${getTranslatedKeyword('if')} number <= 1
    ${getTranslatedKeyword('return')} FALSE
  ${getTranslatedKeyword('endif')}
  
  ${getTranslatedKeyword('repeat')} ${getTranslatedKeyword('for')} i FROM 2 TO number/2
    ${getTranslatedKeyword('if')} number % i EQUALS 0
      ${getTranslatedKeyword('return')} FALSE
    ${getTranslatedKeyword('endif')}
  ${getTranslatedKeyword('endrepeat')}
  
  ${getTranslatedKeyword('return')} TRUE
${getTranslatedKeyword('endfunction')}

// Test the functions
${getTranslatedKeyword('display')} ${getTranslatedKeyword('call')} greetUser("Alice", "english")
${getTranslatedKeyword('display')} "Rectangle area: " + ${getTranslatedKeyword('call')} calculateArea("rectangle", 5, 3)
${getTranslatedKeyword('display')} "Is 17 prime? " + ${getTranslatedKeyword('call')} isPrime(17)`,
        category: 'functions'
      };
    }

    // Error Handling
    if (message.includes('error') || message.includes('debug') || message.includes('fix') || message.includes('not working')) {
      return {
        content: `üîß **PERFECT ERROR HANDLING & DEBUGGING**\n\nComplete error handling system:`,
        codeExample: `${getTranslatedKeyword('display')} "=== ERROR HANDLING SYSTEM ==="

${getTranslatedKeyword('function')} safeDivision(a, b)
  TRY
    ${getTranslatedKeyword('if')} b EQUALS 0
      THROW "Division by zero error!"
    ${getTranslatedKeyword('endif')}
    
    ${getTranslatedKeyword('calculate')} result = a / b
    ${getTranslatedKeyword('return')} result
    
  CATCH error
    ${getTranslatedKeyword('display')} "‚ùå Error: " + error
    ${getTranslatedKeyword('return')} 0
  FINALLY
    ${getTranslatedKeyword('display')} "‚úÖ Division operation completed"
  END TRY
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('function')} validateInput(input)
  ${getTranslatedKeyword('if')} input EQUALS ""
    ${getTranslatedKeyword('display')} "‚ùå Input cannot be empty!"
    ${getTranslatedKeyword('return')} FALSE
  ${getTranslatedKeyword('endif')}
  
  ${getTranslatedKeyword('if')} LENGTH OF input < 3
    ${getTranslatedKeyword('display')} "‚ùå Input too short! Minimum 3 characters"
    ${getTranslatedKeyword('return')} FALSE
  ${getTranslatedKeyword('endif')}
  
  ${getTranslatedKeyword('display')} "‚úÖ Input is valid!"
  ${getTranslatedKeyword('return')} TRUE
${getTranslatedKeyword('endfunction')}

// Test error handling
${getTranslatedKeyword('input')} userInput
${getTranslatedKeyword('if')} ${getTranslatedKeyword('call')} validateInput(userInput)
  ${getTranslatedKeyword('display')} "Processing: " + userInput
${getTranslatedKeyword('endif')}

${getTranslatedKeyword('display')} "Safe division result: " + ${getTranslatedKeyword('call')} safeDivision(10, 0)`,
        category: 'error-handling'
      };
    }

    // Advanced/Custom Request
    return {
      content: `üéØ **CUSTOM CODE SOLUTION**\n\nI understand you want: "${userMessage}"\n\nHere's a complete solution tailored to your needs:`,
      codeExample: `${getTranslatedKeyword('display')} "=== CUSTOM SOLUTION ==="
${getTranslatedKeyword('display')} "Building: ${userMessage}"

// Main program logic
${getTranslatedKeyword('input')} userChoice
${getTranslatedKeyword('display')} "Processing your request..."

${getTranslatedKeyword('function')} processRequest(request)
  ${getTranslatedKeyword('display')} "‚úÖ Executing: " + request
  
  // Add your specific logic here
  ${getTranslatedKeyword('if')} request CONTAINS "data"
    ${getTranslatedKeyword('display')} "üìä Processing data..."
  ${getTranslatedKeyword('otherwise')} ${getTranslatedKeyword('if')} request CONTAINS "calculate"
    ${getTranslatedKeyword('display')} "üßÆ Performing calculations..."
  ${getTranslatedKeyword('otherwise')}
    ${getTranslatedKeyword('display')} "‚ö° Executing custom logic..."
  ${getTranslatedKeyword('endif')}
  
  ${getTranslatedKeyword('display')} "üéâ Task completed successfully!"
${getTranslatedKeyword('endfunction')}

${getTranslatedKeyword('call')} processRequest(userChoice)
${getTranslatedKeyword('display')} "Ready for next task!"`,
      category: 'custom'
    };
  };

  const sendMessage = async () => {
    if (!inputMessage.trim()) return;

    const userMessage: Message = {
      id: Date.now().toString(),
      type: 'user',
      content: inputMessage,
      timestamp: new Date()
    };

    setMessages(prev => [...prev, userMessage]);
    setInputMessage('');
    setIsTyping(true);

    // Simulate AI thinking time
    setTimeout(() => {
      const aiResponse = getAIResponse(inputMessage);
      const aiMessage: Message = {
        id: (Date.now() + 1).toString(),
        type: 'ai',
        content: aiResponse.content,
        codeExample: aiResponse.codeExample,
        category: aiResponse.category,
        timestamp: new Date()
      };

      setMessages(prev => [...prev, aiMessage]);
      setIsTyping(false);
    }, 1500);
  };

  const quickActions = [
    { label: 'üßÆ Calculator', action: () => setInputMessage('Create a complete calculator with all operations') },
    { label: 'üîÑ All Loops', action: () => setInputMessage('Show me FOR, WHILE, DO-WHILE loops') },
    { label: 'üìä All Data Structures', action: () => setInputMessage('Show me arrays, stacks, queues, linked lists, trees') },
    { label: 'üî¢ Matrix Operations', action: () => setInputMessage('Create matrix with mathematical operations') },
    { label: 'ü§ñ Machine Learning', action: () => setInputMessage('Create a machine learning model') },
    { label: 'üìà Data Science', action: () => setInputMessage('Perform data analysis and visualization') },
    { label: 'üß† Neural Network', action: () => setInputMessage('Create a neural network') },
    { label: 'üîç Search Algorithms', action: () => setInputMessage('Show me binary search and linear search') },
    { label: 'üîÑ Sort Algorithms', action: () => setInputMessage('Create bubble sort, quick sort, merge sort') },
    { label: 'üìä DataFrame', action: () => setInputMessage('Create and manipulate dataframes') }
  ];

  const getCategoryIcon = (category: string) => {
    const icons: any = {
      'calculator': 'üßÆ',
      'game': 'üéÆ',
      'data-structures': 'üìä',
      'algorithm': 'üîÑ',
      'database': 'üíæ',
      'file-operations': 'üìÅ',
      'web-development': 'üåê',
      'functions': '‚öôÔ∏è',
      'error-handling': 'üîß',
      'loops': 'üîÑ',
      'basic': 'üëã',
      'custom': 'üéØ',
      'welcome': 'üöÄ'
    };
    return icons[category] || 'üí°';
  };

  return (
    <div className="bg-gray-800 rounded-lg border border-gray-700 h-full flex flex-col">
      {/* Header */}
      <div className="bg-gradient-to-r from-purple-900 to-indigo-900 px-4 py-3 border-b border-gray-700 rounded-t-lg">
        <div className="flex items-center space-x-3">
          <div className="bg-gradient-to-r from-purple-500 to-indigo-500 p-2 rounded-lg">
            <Bot className="w-5 h-5 text-white" />
          </div>
          <div>
            <h3 className="text-lg font-semibold text-white flex items-center">
              <Zap className="w-4 h-4 mr-2 text-yellow-400" />
              100% EFFICIENT AI ASSISTANT
            </h3>
            <p className="text-sm text-purple-200">Perfect code generation in {humanLanguage.toUpperCase()}</p>
          </div>
          <div className="ml-auto">
            <div className="flex items-center space-x-2 text-sm text-purple-200">
              <Target className="w-4 h-4 text-green-400" />
              <span>100% Accuracy</span>
            </div>
          </div>
        </div>
      </div>

      {/* Quick Actions */}
      <div className="p-3 border-b border-gray-700 bg-gray-750">
        <div className="text-xs text-gray-400 mb-2 flex items-center">
          <Sparkles className="w-3 h-3 mr-1" />
          Instant Perfect Code Generation:
        </div>
        <div className="grid grid-cols-2 gap-2">
          {quickActions.map((action, index) => (
            <button
              key={index}
              onClick={action.action}
              className="px-2 py-1 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white text-xs rounded-md transition-all transform hover:scale-105"
            >
              {action.label}
            </button>
          ))}
        </div>
      </div>

      {/* Messages */}
      <div className="flex-1 overflow-y-auto p-4 space-y-4 scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800">
        {messages.map((message) => (
          <div key={message.id} className={`flex ${message.type === 'user' ? 'justify-end' : 'justify-start'}`}>
            <div className={`max-w-[85%] ${message.type === 'user' ? 'order-2' : 'order-1'}`}>
              <div className={`flex items-start space-x-2 ${message.type === 'user' ? 'flex-row-reverse space-x-reverse' : ''}`}>
                <div className={`w-8 h-8 rounded-full flex items-center justify-center ${
                  message.type === 'user' 
                    ? 'bg-indigo-600' 
                    : 'bg-gradient-to-r from-purple-500 to-indigo-500'
                }`}>
                  {message.type === 'user' ? (
                    <User className="w-4 h-4 text-white" />
                  ) : (
                    <Bot className="w-4 h-4 text-white" />
                  )}
                </div>
                <div className={`rounded-lg p-3 ${
                  message.type === 'user'
                    ? 'bg-indigo-600 text-white'
                    : 'bg-gray-700 text-gray-100'
                }`}>
                  <div className="text-sm whitespace-pre-wrap">{message.content}</div>
                  {message.codeExample && (
                    <div className="mt-3">
                      <div className="bg-gray-900 rounded-lg p-3 border border-gray-600">
                        <div className="flex items-center justify-between mb-2">
                          <div className="flex items-center space-x-2">
                            <span className="text-lg">{getCategoryIcon(message.category || 'custom')}</span>
                            <Code className="w-4 h-4 text-indigo-400" />
                            <span className="text-xs text-gray-400">PERFECT SRINJAN CODE</span>
                            <div className="bg-green-600 text-white px-2 py-1 rounded text-xs">
                              100% WORKING
                            </div>
                          </div>
                          <button
                            onClick={() => onCodeSuggestion(message.codeExample!)}
                            className="flex items-center space-x-1 px-3 py-1 bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white text-xs rounded transition-all transform hover:scale-105"
                          >
                            <CheckCircle className="w-3 h-3" />
                            <span>USE THIS CODE</span>
                          </button>
                        </div>
                        <pre className="text-indigo-300 font-mono text-xs leading-relaxed overflow-x-auto">
                          {message.codeExample}
                        </pre>
                      </div>
                    </div>
                  )}
                  <div className="text-xs opacity-75 mt-2">
                    {message.timestamp.toLocaleTimeString()}
                  </div>
                </div>
              </div>
            </div>
          </div>
        ))}
        
        {isTyping && (
          <div className="flex justify-start">
            <div className="flex items-start space-x-2">
              <div className="w-8 h-8 rounded-full bg-gradient-to-r from-purple-500 to-indigo-500 flex items-center justify-center">
                <Bot className="w-4 h-4 text-white" />
              </div>
              <div className="bg-gray-700 rounded-lg p-3">
                <div className="flex items-center space-x-2">
                  <div className="flex space-x-1">
                    <div className="w-2 h-2 bg-indigo-400 rounded-full animate-bounce"></div>
                    <div className="w-2 h-2 bg-indigo-400 rounded-full animate-bounce" style={{ animationDelay: '0.1s' }}></div>
                    <div className="w-2 h-2 bg-indigo-400 rounded-full animate-bounce" style={{ animationDelay: '0.2s' }}></div>
                  </div>
                  <span className="text-sm text-gray-300">Generating perfect code...</span>
                </div>
              </div>
            </div>
          </div>
        )}
        <div ref={messagesEndRef} />
      </div>

      {/* Input */}
      <div className="p-4 border-t border-gray-700">
        <div className="flex space-x-2">
          <input
            type="text"
            value={inputMessage}
            onChange={(e) => setInputMessage(e.target.value)}
            onKeyPress={(e) => e.key === 'Enter' && sendMessage()}
            placeholder={`Describe what you want to build in ${humanLanguage.toUpperCase()}... I'll give you PERFECT code!`}
            className="flex-1 bg-gray-700 text-white px-4 py-2 rounded-lg border border-gray-600 focus:border-indigo-500 focus:outline-none"
          />
          <button
            onClick={sendMessage}
            disabled={!inputMessage.trim()}
            className="bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white px-4 py-2 rounded-lg transition-all transform hover:scale-105"
          >
            <Send className="w-4 h-4" />
          </button>
        </div>
        <div className="text-xs text-gray-400 mt-2 text-center flex items-center justify-center space-x-2">
          <Zap className="w-3 h-3 text-yellow-400" />
          <span>100% Efficient AI ‚Ä¢ Perfect Code Generation ‚Ä¢ Powered by SRINJAN Intelligence</span>
        </div>
      </div>
    </div>
  );
};